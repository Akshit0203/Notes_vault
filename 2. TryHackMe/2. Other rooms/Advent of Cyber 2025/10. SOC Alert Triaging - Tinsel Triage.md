
# Task 2 Alert Triaging Primer

## Alert Triaging

There are many factors you can consider when triaging, but these are the fundamental ones that should always be part of your process of identifying and evaluating alerts:

|   |   |   |
|---|---|---|
|**Key Factors**|**Description**|**Why It Matters?**|
|Severity Level|Review the alert's severity rating, ranging from Informational to Critical.|Indicates the urgency of response and potential business risk.|
|Timestamp and Frequency|Identify when the alert was triggered and check for related activity before and after that time.|Helps identify ongoing attacks or patterns of repeated behaviour.|
|Attack Stage|Determine which stage of the attack lifecycle this alert indicates (reconnaissance, persistence, or data exfiltration).|It gives insight into how far the attacker may have progressed and their objective.|
|Affected Asset|Identify the system, user, or resource involved and assess its importance to operations.|Prioritises response based on the asset's importance and the potential impact of compromise.|

# Task 4 Investigation Proper

## Microsoft Sentinel in Action

To start the activity, navigate to [Microsoft Sentinel](https://portal.azure.com/#browse/microsoft.securityinsightsarg%2Fsentinel) and select your dedicated Sentinel instance. Then, under the **Threat management** dropdown, select the **Incidents** tab to view the incidents triggered during the current timeframe. You may also press the `**<<**` button to expand the view as shown in the image below.

![Microsoft Sentinel Incidents page.](https://tryhackme-images.s3.amazonaws.com/user-uploads/5dbea226085ab6182a2ee0f7/room-content/5dbea226085ab6182a2ee0f7-1761812013900.png)

Since we focus on addressing the most critical threats first, we’ll begin with the high-severity alerts. These represent potential compromise points or privilege-escalation activities that could lead to complete host control if left unchecked.

To begin the triage, we’ll examine one high-severity incident in detail: the **Linux PrivEsc****—Kernel Module Insertion** alert. By clicking the alert, additional details appear on the right-hand side.

![Sentinel Incident: Kernel Module Insertion](https://tryhackme-images.s3.amazonaws.com/user-uploads/5dbea226085ab6182a2ee0f7/room-content/5dbea226085ab6182a2ee0f7-1761813693949.png)

Upon checking the alert, as seen in the above image, the following details can be initially inferred:

1. There are three events related to the alert.
2. The alert was recently created (note that this varies based on your lab instance).
3. There are three entities involved in the alert.
4. The alert is classified as a Privilege Escalation tactic.

We can get further details from here by clicking the **View full details** button.

![View full details button](https://tryhackme-images.s3.amazonaws.com/user-uploads/5dbea226085ab6182a2ee0f7/room-content/5dbea226085ab6182a2ee0f7-1762540605044.png)

In the new view, we can see that in addition to the details shown in the summary, we can also view the possible **Incident Timeline** and **Similar Incidents**.

![Similar incidents and incident timeline.](https://tryhackme-images.s3.amazonaws.com/user-uploads/5dbea226085ab6182a2ee0f7/room-content/5dbea226085ab6182a2ee0f7-1762540510566.png)

### Understanding Related Alerts

When multiple alerts are linked to a single entity, such as the same **machine**, **user**, or **IP address**, it typically indicates that these detections are not isolated incidents, but somewhat different stages of the same intrusion.

By analysing which alerts share the same entities, we can start to trace the attack path, from the initial access to privilege escalation and persistence.

For example, if the same VM triggered the following alerts:

|   |   |
|---|---|
|**Alert**|**What does it suggest?**|
|Root SSH Login from External IP|The attacker gained remote access (via SSH) to the system (Initial Access)|
|SUID Discovery|The attacker looked for ways to escalate privileges.|
|Kernel Module Insertion|The attacker installed a malicious kernel module for persistence.|

At this stage, McSkidy has reviewed the high-severity alerts, identified the affected entities, and noticed that several detections are linked together. This initial triage allows her to prioritise which incidents need immediate attention and recognise when multiple alerts are actually part of a larger compromise.

# Task 5 Diving Deeper Into Logs

If we go back to the alert's full details view, we can try clicking the **Events** from the **Evidence** section.

![Event Evidences from a single alert.](https://tryhackme-images.s3.amazonaws.com/user-uploads/5dbea226085ab6182a2ee0f7/room-content/5dbea226085ab6182a2ee0f7-1761814527567.png)

From this view, we can definitely see the actual name of the kernel module installed in each machine and the time it was installed.

Diving deeper into this, we can try checking the raw events from a single host through a custom query. To do this, let's change the view into an editable KQL query and find all the events triggered from **app-02**.

1. Press the **Simple mode** dropdown from the upper-right corner and select KQL mode.
2. Modify the query with the following KQL query below.  
      
    `set query_now = datetime(2025-10-30T05:09:25.9886229Z);`  
    `Syslog_CL`  
    `| where host_s == 'app-02'`  
    `| project _timestamp_t, host_s, Message`  
      
    
3. Press the **Run** button and wait for the results.

![KQL query mode.](https://tryhackme-images.s3.amazonaws.com/user-uploads/5dbea226085ab6182a2ee0f7/room-content/5dbea226085ab6182a2ee0f7-1761814527687.png)

After executing the query, it can be seen that multiple potentially suspicious events occurred around the installation of the kernel module.

1. Execution of the `cp` (copy) command to create a shadow file backup.
2. Addition of the user account Alice to the sudoers group.
3. Modification of the backupuser account by root.
4. Insertion of the malicious_mod.ko module.
5. Successful SSH authentication by the root user.

![System logs from the app-02 machine.](https://tryhackme-images.s3.amazonaws.com/user-uploads/5dbea226085ab6182a2ee0f7/room-content/5dbea226085ab6182a2ee0f7-1761815790577.png)

Based on the surrounding events, including the execution of the `cp` command to create a shadow file backup, the addition of the user account Alice to the sudoers group, the modification of the backupuser account by root, and the successful SSH authentication by the root user, this activity appears highly unusual. The sequence suggests potential privilege escalation and persistence behaviour, indicating that the event may not be part of normal system operations and warrants further investigation.