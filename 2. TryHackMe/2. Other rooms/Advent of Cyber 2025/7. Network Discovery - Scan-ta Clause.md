
Target in our case, it is the `tbfc-devqa01` server with the `10.48.176.189` IP address.

## **The Simplest Port Scan**

```shell-session
root@attackbox:~# nmap 10.48.176.189
Nmap scan report for 10.48.176.189
Host is up (0.061s latency).
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
```

The command scanned the top 1000 most commonly used ports

## **Scanning Whole Range**

 add the `-p-` argument to scan all ports, and `--script=banner` to see what's likely behind the port:

```shell-session
root@attackbox:~# nmap -p- --script=banner 10.48.176.189
Nmap scan report for 10.48.176.189
Host is up (0.00036s latency).
Not shown: 65531 filtered ports
PORT      STATE SERVICE
22/tcp    open  ssh
|_banner: SSH-2.0-OpenSSH_9.6p1 Ubuntu-3ubuntu13.14
80/tcp    open  http
21212/tcp open  trinket-agent
|_banner: 220 (vsFTPd 3.0.5)
25251/tcp open  unknown
|_banner: TBFC maintd v0.2\x0AType HELP for commands.
```

running FTP server and some custom TBFC application. Even though FTP runs on port 21 by default, it's possible to change the port to any other one, such as 21212. Let's try accessing the FTP in anonymous mode with the `ftp` command

```shell-session
root@attackbox:~# ftp 10.48.176.189 21212
Connected to 10.10.239.62.
Name (10.10.239.62:root): anonymous
ftp> ls
-rw-r--r--  1  ftp  ftp  13 Oct 22 16:27 tbfc_qa_key1
ftp> get tbfc_qa_key1 -
[GET HIDDEN KEY 1 FROM HERE]
ftp> ! # Will exit the FTP shell
```

## **Port Scan Modes**

move on to the custom TBFC app on port 25251. Since it is not a well-known service like HTTP or FTP, your web browser or FTP client won't know how to access it. Luckily, you can always use Netcat (`nc`), a universal tool to interact with network services:

```shell-session
root@attackbox:~# nc -v 10.48.176.189 25251
Connection to 10.10.239.62 25251 port [tcp/*] succeeded!
TBFC maintd v0.2
Type HELP for commands.
HELP                                   # Your input/request
Commands: HELP, STATUS, GET KEY, QUIT  # Server response
[RUN THE CORRECT COMMAND TO GET HIDDEN KEY 2]
```

**Why Netcat?**
Because unlike HTTP (which your browser understands) or FTP (which an FTP client understands), this service runs a **custom protocol**. Netcat is a generic tool that can open a raw TCP connection and let you type commands manually.

**nc** - Netcat command
**-v** - Verbose mode – shows connection details

## **TCP and UDP Ports**

Till now,  we have scanned only TCP ports, but there are also 65535 ports for UDP, another transport protocol. You can switch to UDP scan by specifying the `-sU` flag:

```shell-session
root@attackbox:~# nmap -sU 10.48.176.189
PORT   STATE SERVICE
53/udp open  domain
[...]
```

an open port 53 associated with DNS
`dig` - a command to perform advanced DNS queries:

```shell-session
root@attackbox:~# dig @10.48.176.189 TXT key3.tbfc.local +short
[RUN THE CORRECT COMMAND TO GET HIDDEN KEY 3]
```

|Component|Meaning|
|---|---|
|`dig`|DNS lookup tool|
|`@10.48.176.189`|Query DNS server at IP 10.48.176.189|
|`TXT`|Ask specifically for a TXT record|
|`key3.tbfc.local`|The domain name to query|
|`+short`|Only show the record value (clean output)|
## On-Host Service Discovery

**Listing Listening Ports**

Once you have access to the console, there is no need to scan the ports, as you can simply ask the OS to list its open ports, also called listening ports. You can do it by running `ss -tunlp` (or `netstat` on older systems) inside the Admin Console of the web app. In the output, you may see exactly the same services you scanned before listening on `0.0.0.0`, but also some listening on `127.0.0.1` (available only from the host itself):

```shell-session
tbfcapp@tbfc-devqa01:~$ ss -tunlp
Netid  State   Recv-Q  Send-Q       Local Address:Port      Peer Address:Port  Process                   
udp    UNCONN  0       0                  0.0.0.0:53             0.0.0.0:*                               
udp    UNCONN  0       0        10.10.76.132%ens5:68             0.0.0.0:*                               
tcp    LISTEN  0       50                 0.0.0.0:25251          0.0.0.0:*                               
tcp    LISTEN  0       32                 0.0.0.0:21212          0.0.0.0:*                               
tcp    LISTEN  0       4096               0.0.0.0:22             0.0.0.0:*                               
tcp    LISTEN  0       32                 0.0.0.0:53             0.0.0.0:*                               
tcp    LISTEN  0       511                0.0.0.0:80             0.0.0.0:*                               
tcp    LISTEN  0       2048             127.0.0.1:8000           0.0.0.0:*
tcp    LISTEN  0       151              127.0.0.1:3306           0.0.0.0:*                               
tcp    LISTEN  0       4096             127.0.0.1:7681           0.0.0.0:*                               
tcp    LISTEN  0       4096                  [::]:22                [::]:*                                       
```
This command lists **all currently open (listening) network ports** on the system and shows which services are using them.

It helps you **discover running services** from inside the machine — without needing external port scanning.

| Option | Meaning              | Purpose                                                                        |
| ------ | -------------------- | ------------------------------------------------------------------------------ |
| `ss`   | Socket Statistics    | A tool to investigate network connections, replacing `netstat`                 |
| `-t`   | TCP connections      | Show TCP ports                                                                 |
| `-u`   | UDP connections      | Show UDP ports                                                                 |
| `-n`   | Numeric output       | Show port numbers instead of service names (e.g., **3306** instead of `mysql`) |
| `-l`   | Listening ports only | Show only services **waiting for incoming connections**                        |
| `-p`   | Show processes       | Display which program is using the port (if permissions allow)                 |

Enumerating MySQL Tables

```
tbfcapp@tbfc-devqa01:~$ mysql -D tbfcqa01 -e "show tables;"            
+--------------------+                                                 
| Tables_in_tbfcqa01 |                                                 
+--------------------+                                                 
| flags              |                                                 
+--------------------+                                                 
tbfcapp@tbfc-devqa01:~$ mysql -D tbfcqa01 -e "select * from flags;"    
[GET YOUR FLAG HERE]    
```

|Part|Meaning|Purpose|
|---|---|---|
|`mysql`|The MySQL client program|Used to interact with the MySQL database server|
|`-D tbfcqa01`|Select the database `tbfcqa01`|Tells MySQL which database to work with|
|`-e`|Execute the command that follows|Allows running SQL directly without entering interactive mode|
|`"show tables;"`|SQL query|Lists all tables inside the chosen database|

